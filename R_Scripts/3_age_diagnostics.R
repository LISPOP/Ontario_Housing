install.packages("haven")
install.packages("tidyverse")
library(haven)
library(tidyverse)
#Import Jay's 100% Stata File
on22_jay<-read_dta(file=here("Data/Housing_02_06_100_Percent_Complete.dta"))
#IMport Matt's cleaned up spss file
on22_matt<-read_sav(file=here("Data", "Housing_06_06.sav"))

# Convert ages in Jay's file  f
on22_jay %>% 
  mutate(
    DOB=case_when(
      Q37_DO_NOT_USE==4~1920,
      Q37_DO_NOT_USE==5~1921,
      Q37_DO_NOT_USE==7~1922,
      Q37_DO_NOT_USE==8~1923,
      Q37_DO_NOT_USE==9~1924,
      Q37_DO_NOT_USE==10~1925,
      Q37_DO_NOT_USE==11~1926,
      Q37_DO_NOT_USE==12~1927,
      Q37_DO_NOT_USE==13~1928,
      Q37_DO_NOT_USE==14~1929,
      Q37_DO_NOT_USE==15~1930,
      Q37_DO_NOT_USE==16~1931,
      Q37_DO_NOT_USE==17~1932,
      Q37_DO_NOT_USE==18~1933,
      Q37_DO_NOT_USE==19~1934,
      Q37_DO_NOT_USE==20~1935,
      Q37_DO_NOT_USE==21~1936,
      Q37_DO_NOT_USE==22~1937,
      Q37_DO_NOT_USE==23~1938,
      Q37_DO_NOT_USE==24~1939,
      Q37_DO_NOT_USE==25~1940,
      Q37_DO_NOT_USE==26~1941,
      Q37_DO_NOT_USE==27~1942,
      Q37_DO_NOT_USE==28~1943,
      Q37_DO_NOT_USE==29~1944,
      Q37_DO_NOT_USE==30~1945,
      Q37_DO_NOT_USE==31~1946,
      Q37_DO_NOT_USE==32~1947,
      Q37_DO_NOT_USE==33~1948,
      Q37_DO_NOT_USE==34~1949,
      Q37_DO_NOT_USE==35~1950,
      Q37_DO_NOT_USE==36~1951,
      Q37_DO_NOT_USE==37~1952,
      Q37_DO_NOT_USE==38~1953,
      Q37_DO_NOT_USE==39~1954,
      Q37_DO_NOT_USE==40~1955,
      Q37_DO_NOT_USE==41~1956,
      Q37_DO_NOT_USE==42~1957,
      Q37_DO_NOT_USE==43~1958,
      Q37_DO_NOT_USE==44~1959,
      Q37_DO_NOT_USE==45~1960,
      Q37_DO_NOT_USE==46~1961,
      Q37_DO_NOT_USE==47~1962,
      Q37_DO_NOT_USE==48~1963,
      Q37_DO_NOT_USE==49~1964,
      Q37_DO_NOT_USE==50~1965,
      Q37_DO_NOT_USE==51~1966,
      Q37_DO_NOT_USE==52~1967,
      Q37_DO_NOT_USE==53~1968,
      Q37_DO_NOT_USE==54~1969,
      Q37_DO_NOT_USE==55~1970,
      Q37_DO_NOT_USE==56~1971,
      Q37_DO_NOT_USE==57~1972,
      Q37_DO_NOT_USE==58~1973,
      Q37_DO_NOT_USE==59~1974,
      Q37_DO_NOT_USE==60~1975,
      Q37_DO_NOT_USE==61~1976,
      Q37_DO_NOT_USE==62~1977,
      Q37_DO_NOT_USE==63~1978,
      Q37_DO_NOT_USE==64~1979,
      Q37_DO_NOT_USE==65~1980,
      Q37_DO_NOT_USE==66~1981,
      Q37_DO_NOT_USE==67~1982,
      Q37_DO_NOT_USE==68~1983,
      Q37_DO_NOT_USE==69~1984,
      Q37_DO_NOT_USE==70~1985,
      Q37_DO_NOT_USE==71~1986,
      Q37_DO_NOT_USE==72~1987,
      Q37_DO_NOT_USE==73~1988,
      Q37_DO_NOT_USE==74~1989,
      Q37_DO_NOT_USE==75~1990,
      Q37_DO_NOT_USE==76~1991,
      Q37_DO_NOT_USE==77~1992,
      Q37_DO_NOT_USE==78~1993,
      Q37_DO_NOT_USE==79~1994,
      Q37_DO_NOT_USE==80~1995,
      Q37_DO_NOT_USE==81~1996,
      Q37_DO_NOT_USE==82~1997,
      Q37_DO_NOT_USE==83~1998,
      Q37_DO_NOT_USE==84~1999,
      Q37_DO_NOT_USE==85~2000,
      Q37_DO_NOT_USE==86~2001,
      Q37_DO_NOT_USE==87~2002,
      Q37_DO_NOT_USE==88~2003,
      Q37_DO_NOT_USE==89~2004,
      Q37_DO_NOT_USE==90~2005,
      Q37_DO_NOT_USE==91~2006,
      Q37_DO_NOT_USE==92~2007,
      Q37_DO_NOT_USE==93~2008
    )
  )->on22_jay

#Calculating age in new variable: age
on22_jay$age<-(2022-on22_jay$DOB)
# Convert ages in Matt's shorter file 

on22_matt %>% 
  mutate(
    DOB=case_when(
      Q37==4~1920,
      Q37==5~1921,
      Q37==7~1922,
      Q37==8~1923,
      Q37==9~1924,
      Q37==10~1925,
      Q37==11~1926,
      Q37==12~1927,
      Q37==13~1928,
      Q37==14~1929,
      Q37==15~1930,
      Q37==16~1931,
      Q37==17~1932,
      Q37==18~1933,
      Q37==19~1934,
      Q37==20~1935,
      Q37==21~1936,
      Q37==22~1937,
      Q37==23~1938,
      Q37==24~1939,
      Q37==25~1940,
      Q37==26~1941,
      Q37==27~1942,
      Q37==28~1943,
      Q37==29~1944,
      Q37==30~1945,
      Q37==31~1946,
      Q37==32~1947,
      Q37==33~1948,
      Q37==34~1949,
      Q37==35~1950,
      Q37==36~1951,
      Q37==37~1952,
      Q37==38~1953,
      Q37==39~1954,
      Q37==40~1955,
      Q37==41~1956,
      Q37==42~1957,
      Q37==43~1958,
      Q37==44~1959,
      Q37==45~1960,
      Q37==46~1961,
      Q37==47~1962,
      Q37==48~1963,
      Q37==49~1964,
      Q37==50~1965,
      Q37==51~1966,
      Q37==52~1967,
      Q37==53~1968,
      Q37==54~1969,
      Q37==55~1970,
      Q37==56~1971,
      Q37==57~1972,
      Q37==58~1973,
      Q37==59~1974,
      Q37==60~1975,
      Q37==61~1976,
      Q37==62~1977,
      Q37==63~1978,
      Q37==64~1979,
      Q37==65~1980,
      Q37==66~1981,
      Q37==67~1982,
      Q37==68~1983,
      Q37==69~1984,
      Q37==70~1985,
      Q37==71~1986,
      Q37==72~1987,
      Q37==73~1988,
      Q37==74~1989,
      Q37==75~1990,
      Q37==76~1991,
      Q37==77~1992,
      Q37==78~1993,
      Q37==79~1994,
      Q37==80~1995,
      Q37==81~1996,
      Q37==82~1997,
      Q37==83~1998,
      Q37==84~1999,
      Q37==85~2000,
      Q37==86~2001,
      Q37==87~2002,
      Q37==88~2003,
      Q37==89~2004,
      Q37==90~2005,
      Q37==91~2006,
      Q37==92~2007,
      Q37==93~2008
    )
  )->on22_matt

#Calculating age in new variable: age
on22_matt$age<-(2022-on22_matt$DOB)

ggplot(on22_jay, aes(x=age))+geom_histogram()+geom_vline(xintercept=c(18, 95))+
  labs(title="Age Distribution, OPES22, 100% Complete Stata File")
ggsave(filename=here("Plots","jay_stata_file_age_distribution.png"))

source("R_Scripts/2_recodes.R")
ggplot(on22_matt, aes(x=age))+geom_histogram()+geom_vline(xintercept=c(18, 95))+
  labs(title="Age Distribution, OPES22, Matt's Compressed File")
ggsave(filename=here("Plots","matt_spss_file_age_distribution.png"))
